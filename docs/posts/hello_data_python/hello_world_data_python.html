<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2022-08-03">

<title>iaingallagher.github.io - Hello Data World 2 (python)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">iaingallagher.github.io</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Hello Data World 2 (python)</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">python</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">August 3, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>This is the second of three posts that will carry out data loading, exploration, filtering and statistical testing (frequentist &amp; Bayesian). In the <a href="https://iaingallagher.github.io/posts/hello_data_r/hello_world_data_R.html">first post</a> of the series we used <a href="https://www.r-project.org">R</a>. In this post we’ll use <a href="https://www.python.org">python</a>. Like the previous post there won’t be much exposition - we’ll just move through the process.</p>
<p>If you want to follow along the data are <a href="https://github.com/iaingallagher/iaingallagher.github.io/tree/main/data">here</a>.</p>
<section id="preliminaries" class="level3">
<h3 class="anchored" data-anchor-id="preliminaries">Preliminaries</h3>
<p>Python, like R, has a host of extra packages to help with data import, wrangling, plotting &amp; building various kinds of models. The first step is to load the packages we will need. I use the <a href="https://www.anaconda.com/products/distribution">Anaconda python distribution</a> and packages that are not installed by default can be installed with the <a href="https://conda.io/projects/conda/en/latest/user-guide/getting-started.html"><code>conda</code></a> tool. In this post we use the <code>pymc</code> package for Bayesian modeling. The <a href="">installation notes</a> for <code>pymc</code> recommend installing it into its own python <code>conda</code> environment so this is what I did! To run the code in VSCode I set the relevant <code>python</code> interpreter by using Ctrl+Shift+P to bring up the Command Palette and selecting the relevant python environment. The other packages had to be installed into the same enviroment using <code>conda install</code>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="python_pymc_env_vscode.png" class="img-fluid figure-img" style="width:50.0%"></p>
<p></p><figcaption class="figure-caption">Setting the python environment</figcaption><p></p>
</figure>
</div>
<p>Ok, let’s get on with loading the packages we’ll need!</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd <span class="co"># dataframes for python</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotnine <span class="im">as</span> pn <span class="co"># ggplot2 clone</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>pn.options.figure_size <span class="op">=</span> (<span class="dv">5</span>, <span class="dv">5</span>) <span class="co"># set a default figure size for plotnine plots</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>pn.options.current_theme <span class="op">=</span> pn.theme_bw() <span class="co"># set simple theme</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns <span class="co"># statistical plotting in python land</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>sns.set_theme(style<span class="op">=</span><span class="st">"whitegrid"</span>) <span class="co"># plot theme</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># frequentist modeling</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats <span class="im">as</span> stats <span class="co"># classic freq stats for python</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pingouin <span class="im">as</span> pg <span class="co"># alt to scipy.stats</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># bayesian modeling</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pymc <span class="im">as</span> pm <span class="co"># write your models explicitly</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> bambi <span class="im">as</span> bmb <span class="co"># formula like interface</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> arviz <span class="im">as</span> az <span class="co"># plots for MCMC objects</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="loading-the-data" class="level3">
<h3 class="anchored" data-anchor-id="loading-the-data">Loading the data</h3>
<p>We can use the <code>read_csv()</code> function of the <code>pandas</code> <span class="citation" data-cites="rebackPandasdevPandasPandas2020">(<a href="#ref-rebackPandasdevPandasPandas2020" role="doc-biblioref">Reback et al. 2020</a>)</span> package to read in the data. These data are from body composition practicals run as part of the Sport &amp; Exercise Science degree at the University of Stirling. They were collected over a numbers of years by the students who carried out various measures on themselves.</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>data_in <span class="op">=</span> pd.read_csv(<span class="st">'data/BODY_COMPOSITION_DATA.csv'</span>, sep<span class="op">=</span><span class="st">','</span>, na_values <span class="op">=</span> <span class="st">"NA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exploration-tidying" class="level3">
<h3 class="anchored" data-anchor-id="exploration-tidying">Exploration &amp; tidying</h3>
<p>The <code>pandas</code> package also provides some tools for exploring the data.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data_in.head()</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># examine summary of types etc</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>data_in.info() <span class="co"># there are missing values in bia &amp; HW</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 203 entries, 0 to 202
Data columns (total 10 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   sex        203 non-null    object 
 1   girths     203 non-null    float64
 2   bia        202 non-null    float64
 3   DW         203 non-null    float64
 4   jackson    203 non-null    float64
 5   HW         202 non-null    float64
 6   skinfolds  203 non-null    float64
 7   BMI        203 non-null    float64
 8   WHR        203 non-null    float64
 9   Waist      203 non-null    float64
dtypes: float64(9), object(1)
memory usage: 16.0+ KB</code></pre>
</div>
</div>
<p>We can see that there are some missing values in the BIA and HW variables (these variables have 202 non-null values). There are many ways to deal with missing values but here we will just drop rows with missing values. The <code>dropna()</code> method for <code>pandas</code> dataframes allows us to drop rows (axis 0) or columns (axis 1) with missing values. We also specify the <code>inplace = True</code> argument so that the data we are working on is altered.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># drop the rows (index 0) with missing values; alter dataframe (inplace = True)</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>data_in.dropna(axis <span class="op">=</span> <span class="dv">0</span>, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>data_in.info() <span class="co"># all non-null values</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># summary stats</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>data_in.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 201 entries, 0 to 201
Data columns (total 10 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   sex        201 non-null    object 
 1   girths     201 non-null    float64
 2   bia        201 non-null    float64
 3   DW         201 non-null    float64
 4   jackson    201 non-null    float64
 5   HW         201 non-null    float64
 6   skinfolds  201 non-null    float64
 7   BMI        201 non-null    float64
 8   WHR        201 non-null    float64
 9   Waist      201 non-null    float64
dtypes: float64(9), object(1)
memory usage: 17.3+ KB</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">girths</th>
<th data-quarto-table-cell-role="th">bia</th>
<th data-quarto-table-cell-role="th">DW</th>
<th data-quarto-table-cell-role="th">jackson</th>
<th data-quarto-table-cell-role="th">HW</th>
<th data-quarto-table-cell-role="th">skinfolds</th>
<th data-quarto-table-cell-role="th">BMI</th>
<th data-quarto-table-cell-role="th">WHR</th>
<th data-quarto-table-cell-role="th">Waist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>201.000000</td>
<td>201.000000</td>
<td>201.000000</td>
<td>201.000000</td>
<td>201.000000</td>
<td>201.000000</td>
<td>201.000000</td>
<td>201.000000</td>
<td>201.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>20.734552</td>
<td>16.980100</td>
<td>21.614647</td>
<td>14.212189</td>
<td>21.426408</td>
<td>82.684751</td>
<td>23.223000</td>
<td>0.781529</td>
<td>76.756716</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>8.382091</td>
<td>6.792665</td>
<td>7.307617</td>
<td>7.479344</td>
<td>8.006785</td>
<td>33.108192</td>
<td>3.168286</td>
<td>0.057142</td>
<td>7.352106</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>7.150000</td>
<td>5.700000</td>
<td>4.100000</td>
<td>3.000000</td>
<td>4.100000</td>
<td>27.750000</td>
<td>2.900000</td>
<td>0.670000</td>
<td>61.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>15.080000</td>
<td>11.900000</td>
<td>16.300000</td>
<td>8.000000</td>
<td>15.000000</td>
<td>59.250000</td>
<td>21.170000</td>
<td>0.740000</td>
<td>72.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>20.120000</td>
<td>15.900000</td>
<td>21.400000</td>
<td>12.600000</td>
<td>21.000000</td>
<td>76.230000</td>
<td>23.000000</td>
<td>0.780000</td>
<td>76.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>24.400000</td>
<td>21.200000</td>
<td>28.000000</td>
<td>19.000000</td>
<td>27.000000</td>
<td>100.350000</td>
<td>24.800000</td>
<td>0.815000</td>
<td>81.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>87.900000</td>
<td>39.300000</td>
<td>45.900000</td>
<td>35.000000</td>
<td>43.000000</td>
<td>181.000000</td>
<td>33.030000</td>
<td>0.990000</td>
<td>100.800000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Next we will convert our data from wide format to long format <span class="citation" data-cites="wickham2014">(<a href="#ref-wickham2014" role="doc-biblioref">Wickham 2014</a>)</span> with the <code>pandas.melt()</code> function. Long data makes plotting and statistical analyses easier. In long format data the values for each individual and each measurement technique are identified by rows rather than spread across row &amp; column combinations.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># long data</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>dataL <span class="op">=</span> pd.melt(data_in, id_vars <span class="op">=</span> <span class="st">"sex"</span>, var_name <span class="op">=</span> <span class="st">"method"</span>, value_name <span class="op">=</span> <span class="st">"value"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>dataL.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">sex</th>
<th data-quarto-table-cell-role="th">method</th>
<th data-quarto-table-cell-role="th">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>M</td>
<td>girths</td>
<td>10.85</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>M</td>
<td>girths</td>
<td>14.12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>M</td>
<td>girths</td>
<td>12.30</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>M</td>
<td>girths</td>
<td>8.50</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>M</td>
<td>girths</td>
<td>11.66</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Exploration with plots is an essential step for checking values and the distribution of data. There is an extensive plotting ecosystem in python.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="python_viz_landscape.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Python visualisation landscape (<a href="https://geo-python.github.io/site/lessons/L7/python-plotting.html">source</a>)</figcaption><p></p>
</figure>
</div>
<p>The <code>seaborn</code> <span class="citation" data-cites="waskomSeabornStatisticalData2021">(<a href="#ref-waskomSeabornStatisticalData2021" role="doc-biblioref">Waskom 2021</a>)</span> package provides a high level interface for plotting data &amp; statistical summaries. If you’re used to e.g.&nbsp;<code>ggplot2</code> in R then the <a href="https://plotnine.readthedocs.io/en/stable/"><code>plotnine</code></a> package provides very similar functionality.The tabs below demonstrate the same plot using each of these packages.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">seaborn</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">plotnine</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>fg <span class="op">=</span> sns.FacetGrid(dataL, col <span class="op">=</span> <span class="st">'method'</span>, hue <span class="op">=</span> <span class="st">'sex'</span>, col_wrap <span class="op">=</span> <span class="dv">3</span>, sharey <span class="op">=</span> <span class="va">False</span>)<span class="op">;</span> <span class="co"># create grid</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>fg.<span class="bu">map</span>(sns.stripplot, <span class="st">'sex'</span>, <span class="st">'value'</span>, jitter <span class="op">=</span> <span class="fl">0.05</span>, size <span class="op">=</span> <span class="dv">10</span>, palette<span class="op">=</span>[<span class="st">"firebrick"</span>, <span class="st">"cornflowerblue"</span>], alpha <span class="op">=</span> <span class="fl">0.5</span>, order <span class="op">=</span> [<span class="st">"F"</span>, <span class="st">"M"</span>])<span class="op">;</span> <span class="co"># map stripplot onto grid</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="hello_world_data_python_files/figure-html/cell-7-output-1.png" width="849" height="850"></p>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>pt <span class="op">=</span> pn.ggplot(dataL, pn.aes(<span class="st">'sex'</span>, <span class="st">'value'</span>, colour <span class="op">=</span> <span class="st">'sex'</span>)) <span class="op">+</span> pn.geom_jitter(width <span class="op">=</span> <span class="fl">0.1</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>) <span class="op">+</span> pn.facet_wrap(<span class="st">"method"</span>, scales <span class="op">=</span> <span class="st">"free_y"</span>) <span class="op">+</span> pn.scale_colour_manual(values<span class="op">=</span>[<span class="st">'firebrick'</span>, <span class="st">'cornflowerblue'</span>])</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>pt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/iain/anaconda3/envs/pymc_env/lib/python3.11/site-packages/plotnine/facets/facet.py:440: PlotnineWarning: If you need more space for the x-axis tick text use ... + theme(subplots_adjust={'wspace': 0.25}). Choose an appropriate value for 'wspace'.</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="hello_world_data_python_files/figure-html/cell-8-output-2.png" class="img-fluid"></p>
</div>
</div>
</div>
</div>
</div>
<p>There are a couple of mad values in the <code>BMI</code> and <code>girths</code> variables. For the rest of the analysis we’ll concentrate on the <code>BMI</code> variable. First we’ll filter the data to just BMI.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># filter to just bmi data</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>bmi_data <span class="op">=</span> dataL[dataL.method <span class="op">==</span> <span class="st">"BMI"</span>]</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>bmi_data.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 201 entries, 1206 to 1406
Data columns (total 3 columns):
 #   Column  Non-Null Count  Dtype  
---  ------  --------------  -----  
 0   sex     201 non-null    object 
 1   method  201 non-null    object 
 2   value   201 non-null    float64
dtypes: float64(1), object(2)
memory usage: 6.3+ KB</code></pre>
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first few values</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>bmi_data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">sex</th>
<th data-quarto-table-cell-role="th">method</th>
<th data-quarto-table-cell-role="th">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1206</td>
<td>M</td>
<td>BMI</td>
<td>20.70</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1207</td>
<td>M</td>
<td>BMI</td>
<td>21.90</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1208</td>
<td>M</td>
<td>BMI</td>
<td>21.39</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1209</td>
<td>M</td>
<td>BMI</td>
<td>19.26</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1210</td>
<td>M</td>
<td>BMI</td>
<td>22.30</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>We’ll re-plot these data.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">seaborn</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">plotnine</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>bmi_pt1 <span class="op">=</span> sns.stripplot(x <span class="op">=</span> <span class="st">"sex"</span>, y <span class="op">=</span> <span class="st">"value"</span>, data <span class="op">=</span> bmi_data, jitter <span class="op">=</span> <span class="fl">0.05</span>, palette<span class="op">=</span>[<span class="st">"firebrick"</span>, <span class="st">"cornflowerblue"</span>], alpha <span class="op">=</span> <span class="fl">0.8</span>, order <span class="op">=</span> [<span class="st">"F"</span>, <span class="st">"M"</span>])<span class="op">;</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>bmi_pt1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>&lt;Axes: xlabel='sex', ylabel='value'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="hello_world_data_python_files/figure-html/cell-11-output-2.png" width="592" height="437"></p>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>bmi_pt2 <span class="op">=</span> pn.ggplot(bmi_data, pn.aes(<span class="st">"sex"</span>, <span class="st">"value"</span>, colour <span class="op">=</span> <span class="st">"sex"</span>)) <span class="op">+</span> pn.geom_jitter(width <span class="op">=</span> <span class="fl">0.1</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>) <span class="op">+</span> pn.scale_colour_manual(values <span class="op">=</span> [<span class="st">"firebrick"</span>, <span class="st">"cornflowerblue"</span>])</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>bmi_pt2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="hello_world_data_python_files/figure-html/cell-12-output-1.png" class="img-fluid"></p>
</div>
</div>
</div>
</div>
</div>
<p>We can clearly see the outlier in the male data. Removing outliers is a contentious subject but a BMI of 2 is unrealistic so we’ll remove this value.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># note very low bmi point in M; let's drop that</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>bmi_data <span class="op">=</span> bmi_data[bmi_data.value <span class="op">&gt;</span> <span class="dv">15</span>]</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># summary</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>bmi_data.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>200.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>23.324615</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>2.828887</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>18.080000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>21.177500</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>23.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>24.802500</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>33.030000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">seaborn</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">plotnine</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># seaborn plot</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>bmi_pt3 <span class="op">=</span> sns.stripplot(x <span class="op">=</span> <span class="st">"sex"</span>, y <span class="op">=</span> <span class="st">"value"</span>, data <span class="op">=</span> bmi_data, jitter <span class="op">=</span> <span class="fl">0.05</span>, palette<span class="op">=</span>[<span class="st">"firebrick"</span>, <span class="st">"cornflowerblue"</span>], alpha <span class="op">=</span> <span class="fl">0.8</span>, order <span class="op">=</span> [<span class="st">"F"</span>, <span class="st">"M"</span>])<span class="op">;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>bmi_pt3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>&lt;Axes: xlabel='sex', ylabel='value'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="hello_world_data_python_files/figure-html/cell-14-output-2.png" width="592" height="437"></p>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plotnine plot</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>bmi_pt4 <span class="op">=</span> pn.ggplot(bmi_data, pn.aes(<span class="st">"sex"</span>, <span class="st">"value"</span>, colour <span class="op">=</span> <span class="st">"sex"</span>)) <span class="op">+</span> pn.geom_jitter(width <span class="op">=</span> <span class="fl">0.1</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>) <span class="op">+</span> pn.scale_colour_manual(values <span class="op">=</span> [<span class="st">"firebrick"</span>, <span class="st">"cornflowerblue"</span>])</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>bmi_pt4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="hello_world_data_python_files/figure-html/cell-15-output-1.png" class="img-fluid"></p>
</div>
</div>
</div>
</div>
</div>
<p>Much better!</p>
</section>
</section>
<section id="frequentist-testing" class="level2">
<h2 class="anchored" data-anchor-id="frequentist-testing">Frequentist testing</h2>
<p>We’re now in a position to undertake some statistical analysis. We’ll start with a simple t-test to examine the mean difference in BMI between males and females. The <code>scipy.stats</code> <span class="citation" data-cites="virtanenSciPyFundamentalAlgorithms2020">(<a href="#ref-virtanenSciPyFundamentalAlgorithms2020" role="doc-biblioref">Virtanen et al. 2020</a>)</span> library provides functions for one sample, paired &amp; independent t-tests (and other tests). We first extract the data we want to test into separate series and then pass these series to the appropriate function. The <code>stats.ttest_ind()</code> function returns a tuple containing the t-statistic and the p-value for the test and we can extract these and print those. The <code>equal_var = False</code> argument means we get Welch’s t-test which <em>doesn’t</em> assume equal variances in each group.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test diff between men &amp; women; get data</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>male_data <span class="op">=</span> bmi_data[bmi_data.sex <span class="op">==</span> <span class="st">"M"</span>]</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>female_data <span class="op">=</span> bmi_data[bmi_data.sex <span class="op">==</span> <span class="st">"F"</span>]</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># do the test</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>t_res <span class="op">=</span> stats.ttest_ind(male_data.value, female_data.value, equal_var <span class="op">=</span> <span class="va">False</span>) <span class="co"># tuple out, t-stat and p-value</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>t_res</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co"># print informative result</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The t-statistic is </span><span class="sc">%.2f</span><span class="st"> with a p-value of </span><span class="sc">%.3f</span><span class="st">."</span> <span class="op">%</span> (t_res[<span class="dv">0</span>], t_res[<span class="dv">1</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The t-statistic is 2.11 with a p-value of 0.036.</code></pre>
</div>
</div>
<p>The <code>pingouin</code> <span class="citation" data-cites="vallatPingouinStatisticsPython2018">(<a href="#ref-vallatPingouinStatisticsPython2018" role="doc-biblioref">Vallat 2018</a>)</span> package also provides functions for statistical testing.</p>
<p>Using the <code>ttest()</code> function with <code>correction = 'auto'</code> means <code>pingouin</code> automatically uses Welch’s T-test when the sample sizes are unequal as they are here.</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pingouin example; correction =‘auto’</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>pg.ttest(male_data.value, female_data.value, paired <span class="op">=</span> <span class="va">False</span>, correction <span class="op">=</span> <span class="st">'auto'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">T</th>
<th data-quarto-table-cell-role="th">dof</th>
<th data-quarto-table-cell-role="th">alternative</th>
<th data-quarto-table-cell-role="th">p-val</th>
<th data-quarto-table-cell-role="th">CI95%</th>
<th data-quarto-table-cell-role="th">cohen-d</th>
<th data-quarto-table-cell-role="th">BF10</th>
<th data-quarto-table-cell-role="th">power</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">T-test</td>
<td>2.11342</td>
<td>192.047574</td>
<td>two-sided</td>
<td>0.035856</td>
<td>[0.05, 1.59]</td>
<td>0.293662</td>
<td>1.242</td>
<td>0.529014</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The <code>pingouin</code> package provides us with much more information - which may or may not be useful to you. The difference between male &amp; female BMI is significant. This means that in a hypothetical long series of repeats of this study with different samples from the same population we would expect to see a difference as big or bigger between the sexes in more than 95% of those repeats. The <code>pingouin</code> package also reports the power of the test here. This is post-hoc power though &amp; post-hoc power is witchcraft e.g. <span class="citation" data-cites="gelmanDonCalculatePosthoc2019">(<a href="#ref-gelmanDonCalculatePosthoc2019" role="doc-biblioref">Gelman 2019</a>)</span>.</p>
</section>
<section id="bayesian-testing" class="level2">
<h2 class="anchored" data-anchor-id="bayesian-testing">Bayesian testing</h2>
<p>In the previous post with R we used the Stan probabilistic programming language to create a Bayesian model for the BMI data. We could also use Stan here via the <a href="https://pystan.readthedocs.io/en/latest/index.html">pystan</a> interface but instead we’ll use a native python library called [<code>pymc</code>] <span class="citation" data-cites="salvatierProbabilisticProgrammingPython2016">(<a href="#ref-salvatierProbabilisticProgrammingPython2016" role="doc-biblioref">Salvatier, Wiecki, and Fonnesbeck 2016</a>)</span>. The <code>pymc</code> package allows us to write data generating models and then use Markov Chain Monte Carlo (MCMC) sampling with those model definitions to generate posterior distributions. <code>pymc</code> supports a range of MCMC algorithms. In the code below we use the same priors we defined in the post using R.</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bayesian test with pymc</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># create dummy variables; F = 0, M = 1</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>bmi_data_dummy <span class="op">=</span> pd.get_dummies(bmi_data, columns <span class="op">=</span> [<span class="st">"sex"</span>], drop_first <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># set up priors &amp; likelihood</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># https://docs.pymc.io/en/latest/api/generated/pymc.sample.html</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> pm.Model() <span class="im">as</span> model:  <span class="co"># model specifications in PyMC3 are wrapped in a `with` statement</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define priors</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    sigma <span class="op">=</span> pm.HalfNormal(<span class="st">"sigma"</span>, sigma <span class="op">=</span> <span class="dv">100</span>)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    intercept <span class="op">=</span> pm.Normal(<span class="st">"Intercept"</span>, mu <span class="op">=</span> <span class="dv">25</span>, sigma<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    x_coeff <span class="op">=</span> pm.Normal(<span class="st">"male_diff"</span>, mu <span class="op">=</span> <span class="dv">0</span>, sigma <span class="op">=</span> <span class="dv">5</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define likelihood</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    likelihood <span class="op">=</span> pm.Normal(<span class="st">"value"</span>, mu <span class="op">=</span> intercept <span class="op">+</span> x_coeff <span class="op">*</span> bmi_data_dummy.sex_M, sigma<span class="op">=</span>sigma, observed<span class="op">=</span>bmi_data_dummy.value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next we run the MCMC sampling on the model we defined above; by default the NUTS algorithm is used. This is the same MCMC algorithm as the <code>Stan</code> probabilistic progamming language uses by default. Using <code>return_inferencedata = True</code> means we can easily plot the results (see below).</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MCMC sampling</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 MCMC chains</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co"># draw 3000 posterior samples using NUTS sampling; 1000 iter burn-in</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> model:</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    bayes_bmi <span class="op">=</span> pm.sample(<span class="dv">3000</span>, tune <span class="op">=</span> <span class="dv">1000</span>, return_inferencedata <span class="op">=</span> <span class="va">True</span>, chains <span class="op">=</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (3 chains in 4 jobs)
NUTS: [sigma, Intercept, male_diff]
Sampling 3 chains for 1_000 tune and 3_000 draw iterations (3_000 + 9_000 draws total) took 2 seconds.</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="12000" class="" max="12000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [12000/12000 00:01&lt;00:00 Sampling 3 chains, 0 divergences]
    </div>
    
</div>
</div>
<p>The <code>arviz</code> library <span class="citation" data-cites="kumarArviZUnifiedLibrary2019a">(<a href="#ref-kumarArviZUnifiedLibrary2019a" role="doc-biblioref">Kumar et al. 2019</a>)</span> provides tools for summarising &amp; plotting data from MCMC chains &amp; posterior distributions.</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>az.plot_trace(bayes_bmi)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="hello_world_data_python_files/figure-html/cell-20-output-1.png" width="912" height="507"></p>
</div>
</div>
<p>We want the traceplots (on the right) to look like ‘hairy caterpillars’ &amp; they all look fine here. The posterior distributions for each parameter also look healthy. We can plot the posteriors using <code>arviz</code> as well.</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>az.plot_posterior(bayes_bmi, grid <span class="op">=</span> (<span class="dv">2</span>,<span class="dv">2</span>), hdi_prob <span class="op">=</span> <span class="fl">0.95</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="hello_world_data_python_files/figure-html/cell-21-output-1.png" width="1217" height="912"></p>
</div>
</div>
<p>The posterior distributions all look good. We can extract the intercept posterior and the posterior for the effect of ‘male’ and add these together to get the posterior for male BMI.</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add Intercept &amp; male diff posteriors; keep this new posterior in existing InferenceData object</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>bayes_bmi.posterior[<span class="st">"male_bmi"</span>] <span class="op">=</span> bayes_bmi.posterior[<span class="st">"Intercept"</span>] <span class="op">+</span> bayes_bmi.posterior[<span class="st">"male_diff"</span>]</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># replot with only intercept (female BMI), male BMI and sigma</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>az.plot_posterior(bayes_bmi, var_names <span class="op">=</span> [<span class="st">"Intercept"</span>, <span class="st">"male_bmi"</span>, <span class="st">"sigma"</span>]  , grid <span class="op">=</span> (<span class="dv">2</span>,<span class="dv">2</span>), hdi_prob <span class="op">=</span> <span class="fl">0.95</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="hello_world_data_python_files/figure-html/cell-22-output-1.png" width="1217" height="912"></p>
</div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>az.summary(bayes_bmi, var_names <span class="op">=</span> [<span class="st">"Intercept"</span>, <span class="st">"male_bmi"</span>, <span class="st">"sigma"</span>] , kind <span class="op">=</span> <span class="st">"stats"</span>, hdi_prob <span class="op">=</span> <span class="fl">0.9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">sd</th>
<th data-quarto-table-cell-role="th">hdi_5%</th>
<th data-quarto-table-cell-role="th">hdi_95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Intercept</td>
<td>22.835</td>
<td>0.316</td>
<td>22.292</td>
<td>23.317</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">male_bmi</td>
<td>23.661</td>
<td>0.258</td>
<td>23.247</td>
<td>24.099</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">sigma</td>
<td>2.826</td>
<td>0.143</td>
<td>2.588</td>
<td>3.051</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The output tells us that the estimated mean for female BMI is 22.8 (females were dummy coded as 0). Given the priors we used we can say that there is a 90% probability that the value for female BMI lies between 22.3 and 23.4. The estimated male BMI is 23.6 with 90% probability of being between 23.2 &amp; 24. Note that the actual values might vary in the decimal point because the MCMC chains are random.</p>
<p>The <code>bambi</code> library <span class="citation" data-cites="caprettoBambiSimpleInterface2022">(<a href="#ref-caprettoBambiSimpleInterface2022" role="doc-biblioref">Capretto et al. 2022</a>)</span> can be used to create Bayesian models with a more intuitive formula interface like <code>brms</code> or <code>rstanarm</code> in R.</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model with bambi</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># define priors</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>prior_spec <span class="op">=</span> {</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Intercept"</span>: bmb.Prior(<span class="st">"Normal"</span>, mu <span class="op">=</span> <span class="dv">25</span>, sigma <span class="op">=</span> <span class="dv">10</span>),</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"sex_M"</span>: bmb.Prior(<span class="st">"Normal"</span>, mu <span class="op">=</span> <span class="dv">0</span>, sigma <span class="op">=</span> <span class="dv">5</span>),</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"value_sigma"</span>: bmb.Prior(<span class="st">"HalfNormal"</span>, sigma <span class="op">=</span> <span class="dv">100</span>)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co"># define the model; formula syntax</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>bmb_bayes_model <span class="op">=</span> bmb.Model(<span class="st">"value ~ sex"</span>, priors <span class="op">=</span> prior_spec, data <span class="op">=</span> bmi_data)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="co"># MCMC sampling; returns InferenceData obj</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>bmb_bayes_bmi <span class="op">=</span> bmb_bayes_model.fit(draws <span class="op">=</span> <span class="dv">3000</span>, tune <span class="op">=</span> <span class="dv">1000</span>, chains <span class="op">=</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (3 chains in 4 jobs)
NUTS: [value_sigma, Intercept, sex]
Sampling 3 chains for 1_000 tune and 3_000 draw iterations (3_000 + 9_000 draws total) took 2 seconds.</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="12000" class="" max="12000" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [12000/12000 00:01&lt;00:00 Sampling 3 chains, 0 divergences]
    </div>
    
</div>
</div>
<p>The <code>bmb_bayes_bmi</code> object is of type <code>InferenceData</code> like that returned from <code>pymc</code> (<code>bambi</code> uses <code>pymc</code> under the hood). We can use the <code>bambi</code> result in the same way we used the <code>pymc</code> result with <code>arviz</code>.</p>
<p>First we’ll plot the posterior distributions and plots for each MCMC chain.</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plots and dists</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>az.plot_trace(bmb_bayes_bmi)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="hello_world_data_python_files/figure-html/cell-25-output-1.png" width="912" height="507"></p>
</div>
</div>
<p>Next we’ll plot the posterior distributions and get summaries of those posteriors.</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot posteriors</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>az.plot_posterior(bmb_bayes_bmi, grid <span class="op">=</span> (<span class="dv">2</span>,<span class="dv">2</span>), hdi_prob <span class="op">=</span> <span class="fl">0.95</span>)<span class="op">;</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Key summary and diagnostic info on the model parameters</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>az.summary(bmb_bayes_bmi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">sd</th>
<th data-quarto-table-cell-role="th">hdi_3%</th>
<th data-quarto-table-cell-role="th">hdi_97%</th>
<th data-quarto-table-cell-role="th">mcse_mean</th>
<th data-quarto-table-cell-role="th">mcse_sd</th>
<th data-quarto-table-cell-role="th">ess_bulk</th>
<th data-quarto-table-cell-role="th">ess_tail</th>
<th data-quarto-table-cell-role="th">r_hat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Intercept</td>
<td>22.840</td>
<td>0.309</td>
<td>22.255</td>
<td>23.417</td>
<td>0.003</td>
<td>0.002</td>
<td>15248.0</td>
<td>7273.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">sex[M]</td>
<td>0.828</td>
<td>0.406</td>
<td>0.027</td>
<td>1.549</td>
<td>0.003</td>
<td>0.003</td>
<td>15087.0</td>
<td>7029.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">value_sigma</td>
<td>2.816</td>
<td>0.144</td>
<td>2.545</td>
<td>3.086</td>
<td>0.001</td>
<td>0.001</td>
<td>12954.0</td>
<td>6515.0</td>
<td>1.0</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<p><img src="hello_world_data_python_files/figure-html/cell-26-output-2.png" width="1217" height="928"></p>
</div>
</div>
<p>We get some extra information using the <code>bambi</code> summary.</p>
<p>As we did in the <code>pymc3</code> example we can add the <code>Intercept</code> and <code>sex</code> chains together to get a posterior distribution for the male BMI and add this data to our existing `` object.</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>bmb_bayes_bmi.posterior[<span class="st">"male_bmi"</span>] <span class="op">=</span> bmb_bayes_bmi.posterior[<span class="st">"Intercept"</span>] <span class="op">+</span> bmb_bayes_bmi.posterior[<span class="st">"sex"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can easily summarise &amp; plot the parameters we are interested in.</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot selected posteriors</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>az.plot_posterior(bmb_bayes_bmi, var_names <span class="op">=</span> [<span class="st">"Intercept"</span>, <span class="st">"male_bmi"</span>, <span class="st">"value_sigma"</span>], grid <span class="op">=</span> (<span class="dv">2</span>,<span class="dv">2</span>), hdi_prob <span class="op">=</span> <span class="fl">0.95</span>)<span class="op">;</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># posterior summary</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>az.summary(bmb_bayes_bmi, var_names <span class="op">=</span> [<span class="st">"Intercept"</span>, <span class="st">"male_bmi"</span>, <span class="st">"value_sigma"</span>], kind <span class="op">=</span> <span class="st">"stats"</span>, hdi_prob <span class="op">=</span> <span class="fl">0.9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">mean</th>
<th data-quarto-table-cell-role="th">sd</th>
<th data-quarto-table-cell-role="th">hdi_5%</th>
<th data-quarto-table-cell-role="th">hdi_95%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Intercept</td>
<td>22.840</td>
<td>0.309</td>
<td>22.322</td>
<td>23.335</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">male_bmi[M]</td>
<td>23.668</td>
<td>0.259</td>
<td>23.249</td>
<td>24.091</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">value_sigma</td>
<td>2.816</td>
<td>0.144</td>
<td>2.570</td>
<td>3.043</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<p><img src="hello_world_data_python_files/figure-html/cell-28-output-2.png" width="1227" height="928"></p>
</div>
</div>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>This post has been a quick skip through some data loading, exploration, filtering and both frequentist &amp; Bayesian modelling with python.</p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-caprettoBambiSimpleInterface2022" class="csl-entry" role="listitem">
Capretto, Tomás, Camen Piho, Ravin Kumar, Jacob Westfall, Tal Yarkoni, and Osvaldo A. Martin. 2022. <span>“Bambi: <span>A</span> Simple Interface for Fitting <span>Bayesian</span> Linear Models in <span>Python</span>.”</span> <span>arXiv</span>. <a href="https://doi.org/10.48550/arXiv.2012.10754">https://doi.org/10.48550/arXiv.2012.10754</a>.
</div>
<div id="ref-gelmanDonCalculatePosthoc2019" class="csl-entry" role="listitem">
Gelman, Andrew. 2019. <span>“Don’t <span class="nocase">Calculate Post-hoc Power Using Observed Estimate</span> of <span>Effect Size</span>.”</span> <em>Annals of Surgery</em> 269 (1): e9–10. <a href="https://doi.org/10.1097/SLA.0000000000002908">https://doi.org/10.1097/SLA.0000000000002908</a>.
</div>
<div id="ref-kumarArviZUnifiedLibrary2019a" class="csl-entry" role="listitem">
Kumar, Ravin, Colin Carroll, Ari Hartikainen, and Osvaldo Martin. 2019. <span>“<span>ArviZ</span> a Unified Library for Exploratory Analysis of <span>Bayesian</span> Models in <span>Python</span>.”</span> <em>Journal of Open Source Software</em> 4 (33): 1143. <a href="https://doi.org/10.21105/joss.01143">https://doi.org/10.21105/joss.01143</a>.
</div>
<div id="ref-rebackPandasdevPandasPandas2020" class="csl-entry" role="listitem">
Reback, Jeff, Wes McKinney, jbrockmendel, Joris Van den Bossche, Tom Augspurger, Phillip Cloud, gfyoung, et al. 2020. <span>“Pandas-Dev/Pandas: <span>Pandas</span> 1.0.3.”</span> Zenodo. <a href="https://doi.org/10.5281/zenodo.3715232">https://doi.org/10.5281/zenodo.3715232</a>.
</div>
<div id="ref-salvatierProbabilisticProgrammingPython2016" class="csl-entry" role="listitem">
Salvatier, John, Thomas V. Wiecki, and Christopher Fonnesbeck. 2016. <span>“Probabilistic Programming in <span>Python</span> Using <span>PyMC3</span>.”</span> <em>PeerJ Computer Science</em> 2 (April): e55. <a href="https://doi.org/10.7717/peerj-cs.55">https://doi.org/10.7717/peerj-cs.55</a>.
</div>
<div id="ref-vallatPingouinStatisticsPython2018" class="csl-entry" role="listitem">
Vallat, Raphael. 2018. <span>“Pingouin: Statistics in <span>Python</span>.”</span> <em>Journal of Open Source Software</em> 3 (31): 1026. <a href="https://doi.org/10.21105/joss.01026">https://doi.org/10.21105/joss.01026</a>.
</div>
<div id="ref-virtanenSciPyFundamentalAlgorithms2020" class="csl-entry" role="listitem">
Virtanen, Pauli, Ralf Gommers, Travis E. Oliphant, Matt Haberland, Tyler Reddy, David Cournapeau, Evgeni Burovski, et al. 2020. <span>“<span>SciPy</span> 1.0: Fundamental Algorithms for Scientific Computing in <span>Python</span>.”</span> <em>Nature Methods</em> 17 (3): 261–72. <a href="https://doi.org/10.1038/s41592-019-0686-2">https://doi.org/10.1038/s41592-019-0686-2</a>.
</div>
<div id="ref-waskomSeabornStatisticalData2021" class="csl-entry" role="listitem">
Waskom, Michael L. 2021. <span>“Seaborn: Statistical Data Visualization.”</span> <em>Journal of Open Source Software</em> 6 (60): 3021. <a href="https://doi.org/10.21105/joss.03021">https://doi.org/10.21105/joss.03021</a>.
</div>
<div id="ref-wickham2014" class="csl-entry" role="listitem">
Wickham, Hadley. 2014. <span>“Tidy Data.”</span> <em>Journal of Statistical Software</em> 59 (1): 1–23. <a href="https://doi.org/10.18637/jss.v059.i10">https://doi.org/10.18637/jss.v059.i10</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>